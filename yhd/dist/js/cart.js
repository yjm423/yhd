"use strict";var baseUrl="http://localhost/project/yhd/yhd/";define(["jquery","cookie"],function(r,n){return{render:function(){var i=r.cookie("shop");if(i){var n=(i=JSON.parse(i)).map(function(n){return n.id}).join(),t=this;r.ajax({url:baseUrl+"lib/cart.php",data:{id:n},type:"get",dataType:"json",success:function(n){var e="";n.forEach(function(n,t){e+='\n                            <li class="clearfix" id='+n.sid+'>\n                            <input type="checkbox" checked>\n                            <img src="'+n.url.split(",")[0]+'" alt="">\n                            <p class="item_tit">'+n.title+' </p>\n                            <span class="price">'+n.pricenew+'</span>\n                            <div class="num">\n                                <span class=\'reduce\'>-</span>\n                                <input type="text" value=\''+i[t].num+'\'>\n                                <span class=\'add\'>+</span>\n                            </div>\n                            <div class="price_wrap">\n                                <div class="all_price">'+(n.pricenew*i[t].num).toFixed(2)+'</div>\n                            </div>\n                            <div class="item_act"> <a href="javascript:location.reload();"><button>删除</button></a></div>\n                           \n                            </li>\n                            '}),r(".cart_prod ul").append(e),t.numchange()}})}},numchange:function(){r(".num .add").on("click",function(){var n=r(this).parent().children("input").val();n++,r(this).parent().children("input").val(n),e(r(this)),t()}),r(".num .reduce").on("click",function(){var n=r(this).parent().children("input").val();n<=1?n=0:(n--,r(this).parent().children("input").val(n),e(r(this)),t())});var i=r.cookie("shop");function t(){var n=0,t=r("input:checked").not(".allselector").parents("li").find(".all_price");console.log(t);var e=!0,i=!1,c=void 0;try{for(var a,l=t[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var o=a.value;n+=Number(r(o).html())}}catch(n){i=!0,c=n}finally{try{!e&&l.return&&l.return()}finally{if(i)throw c}}r(".money b").html(n.toFixed(2))}function e(n){var t=n.parents("li").find(".price"),e=(r(t).html()*n.parent().children("input").val()).toFixed(2);n.parents("li").find(".all_price").html(e)}i&&(i=JSON.parse(i),r(".num_count b").html(i.length)),r(".num input").on("blur",function(){e(r(this)),t()}),r("button").on("click",function(){r(this).parents("li").remove();var e=r(this).parents("li").attr("id");i.forEach(function(n,t){n.id===e&&i.splice(t,1),r.cookie("shop",JSON.stringify(i)),console.log(r.cookie("shop"))}),window.location.reload}),t(),r(".allselector").on("click",function(){r(this).prop("checked")?r("input").prop("checked",!0):r("input").prop("checked",!1)});var n=r("input[type='checkbox']").length;console.log(r("input[type='checkbox']")),console.log(n),r("input").on("click",function(){r(".cart_prod input:checked").not(".allselector").length===n-1?r(".allselector").prop("checked",!0):r(".allselector").prop("checked",!1),t()})}}});